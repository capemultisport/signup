
<script>
  // Get URL parameter
  const params = new URLSearchParams(window.location.search);
  const mode = params.get('mode') || 'renew'; // default to renew if not provided

  // Define price sets
  const priceSets = {
    renew: [
      { id: 'prod-a', label: 'Full member', price: 360 },
      { id: 'prod-b', label: 'Family, Junior, Pensioner', price: 245 },
      { id: 'prod-c', label: 'Up-country', price: 180 },
      { id: 'prod-d', label: 'ASA', price: 190 }
    ],
    new: [
      { id: 'prod-a', label: 'Full member', price: 460 },
      { id: 'prod-b', label: 'Family, Junior, Pensioner', price: 295 },
      { id: 'prod-c', label: 'Up-country', price: 230 },
      { id: 'prod-d', label: 'ASA', price: 190 }
    ]
  };

  // Pick correct set
  const items = priceSets[mode];

  // Reference based on mode
  const reference = mode === 'renew' ? 'MembershipBlackFriday' : 'NewMembershipBlackFriday';

  // Render items dynamically
  const container = document.getElementById('items-container');
  items.forEach((item, index) => {
    const card = document.createElement('article');
    card.className = 'card';
    card.innerHTML = `
      <div class="card-title">${item.label}</div>
      <div class="price">Price: R${item.price.toFixed(2)}</div>
      <div class="control">
        <label for="qty-${index}">Quantity</label>
        <select class="qty" id="qty-${index}">
          <option value="0" selected>0</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
        </select>
      </div>
    `;
    container.appendChild(card);
    document.getElementById(`qty-${index}`).addEventListener('change', updateTotal);
  });

  function calculateTotal() {
    let total = 0;
    items.forEach((item, index) => {
      const qty = parseInt(document.getElementById(`qty-${index}`).value);
      total += item.price * qty;
    });
    return total;
  }

  function updateTotal() {
    const total = calculateTotal();
    document.getElementById('total').textContent = `Total: R${total.toFixed(2)}`;
  }

  function proceedToPayment() {
    const total = calculateTotal();
    if (total <= 0) {
      alert('Please choose at least one product.');
      return;
    }
    const baseUrl = 'https://pay.yoco.com/cape-multisport-club';
    const amount = total.toFixed(2);
    const url = `${baseUrl}?amount=${encodeURIComponent(amount)}&reference=${encodeURIComponent(reference)}`;
    window.location.assign(url);
  }

  updateTotal();
</script>
